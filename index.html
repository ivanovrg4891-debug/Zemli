<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–°–∞–º—ñ—Ç–Ω—ñ –ó–µ–º–ª—ñ</title>
<style>
body { font-family:"Courier New", monospace; background:#1b1b1b; color:#f0f0f0; margin:0; padding:0; }
#container { display:flex; height:100vh; }
#main { flex:2; padding:20px; background:#2c2c2c; position:relative; }
#sidebar { flex:1; padding:20px; background:#333; }
#location-img { width:100%; height:200px; background:#555 center/cover no-repeat; margin-bottom:10px; border:1px solid #666; }
button { background:#444; color:#f0f0f0; border:1px solid #666; padding:10px; margin:5px; cursor:pointer; width:120px; }
#battle-log { background:#222; height:180px; overflow-y:auto; padding:10px; margin-top:10px; border:1px solid #666; }
h2{ margin:5px 0;} .stat{ margin:5px 0;}
/* –ú–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞ */
.modal { display:none; position:absolute; top:20%; left:25%; width:50%; height:50%; background:#222; border:2px solid #666; padding:20px; overflow-y:auto;}
.modal h3 { margin-top:0; }
.item { border:1px solid #666; padding:5px; margin:5px; display:flex; align-items:center; }
.item img { width:40px; height:40px; margin-right:10px; }
</style>
</head>
<body>
<div id="container">
  <div id="main">
    <div id="location-img"></div>
    <h2 id="location-name"></h2>
    <p id="location-text"></p>
    <div>
      <button onclick="attackMob()">üó°Ô∏è –ü–æ–ª—é–≤–∞–Ω–Ω—è</button>
      <button onclick="explore()">üß≠ –î–æ—Å–ª—ñ–¥–∏—Ç–∏</button>
      <button onclick="openInventory()">üéí –Ü–Ω–≤–µ–Ω—Ç–∞—Ä</button>
      <button onclick="showCharacter()">üë§ –ü–µ—Ä—Å–æ–Ω–∞–∂</button>
      <button onclick="openCraft()">‚öíÔ∏è –ö—Ä–∞—Ñ—Ç</button>
      <button onclick="changeLocationUI()">üåç –õ–æ–∫–∞—Ü—ñ—ó</button>
    </div>
    <div id="battle-log"></div>

    <!-- –Ü–Ω–≤–µ–Ω—Ç–∞—Ä -->
    <div id="inventory-modal" class="modal">
      <h3>–Ü–Ω–≤–µ–Ω—Ç–∞—Ä</h3>
      <div id="inventory-items"></div>
      <button onclick="closeInventory()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>

    <!-- –ö—Ä–∞—Ñ—Ç -->
    <div id="craft-modal" class="modal">
      <h3>–ö—Ä–∞—Ñ—Ç</h3>
      <div id="craft-list"></div>
      <button onclick="closeCraft()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>

    <!-- –í–∏–±—ñ—Ä –ª–æ–∫–∞—Ü—ñ—ó -->
    <div id="location-modal" class="modal">
      <h3>–í–∏–±—ñ—Ä –ª–æ–∫–∞—Ü—ñ—ó</h3>
      <div id="location-list"></div>
      <button onclick="closeLocationModal()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>

  <div id="sidebar">
    <h2>–ü–µ—Ä—Å–æ–Ω–∞–∂</h2>
    <div class="stat">–Ü–º'—è: –ì–µ—Ä–æ–π</div>
    <div class="stat">–†—ñ–≤–µ–Ω—å: <span id="level">1</span></div>
    <div class="stat">HP: <span id="hp">35</span></div>
    <div class="stat">EXP: <span id="exp">0</span></div>
    <div class="stat">–°–∏–ª–∞: 3</div>
    <div class="stat">–°–ø—Ä–∏—Ç–Ω—ñ—Å—Ç—å: 3</div>
    <div class="stat">–í–∏—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: 3</div>
    <div class="stat">–£–¥–∞—á–∞: 2</div>
    <div class="stat">–ú–∞–π—Å—Ç–µ—Ä–Ω—ñ—Å—Ç—å: 2</div>
  </div>
</div>

<script>
let character = {
  hp:35, level:1, exp:0, strength:3, agility:3, endurance:3, luck:2, mastery:2,
  inventory:[{name:"–°—Ç–∞—Ä–∏–π –Ω—ñ–∂", img:"https://i.imgur.com/ZbZ6F5B.png"},{name:"–ü–æ—Ç–µ—Ä—Ç–∞ –∫—É—Ä—Ç–∫–∞", img:"https://i.imgur.com/6XJdU8V.png"}]
};

let locations = [
  {name:"–î–∏–∫–µ –£–∑–±–µ—Ä–µ–∂–∂—è", img:"/storage/emulated/0/Gamephoto/Loc1.png", text:"–í—ñ—Ç–µ—Ä –∑ –º–æ—Ä—è –Ω–µ—Å–µ –∑–∞–ø–∞—Ö —Å–æ–ª—ñ —Ç–∞ –≥–Ω–∏–ª–æ—ó –¥–µ—Ä–µ–≤–∏–Ω–∏. –î–µ—Å—å –Ω–µ–ø–æ–¥–∞–ª—ñ–∫ —á—É—Ç–∏ —à—É—Ä—Ö—ñ—Ç ‚Äî —Ç—É—Ç —Ç–∏ –Ω–µ –æ–¥–∏–Ω...",
   mobs:[
     {name:"–î–∏–∫–∏–π –©—É—Ä", hp:18, str:2, agi:3, armor:1, exp:5, drops:[{name:"–•—É—Ç—Ä–æ", img:"https://i.imgur.com/1SgX3sJ.png", chance:0.6},{name:"–ö—ñ—Å—Ç–∫–∞", img:"https://i.imgur.com/5tXeGjB.png", chance:0.3}], img:"https://i.imgur.com/1SgX3sJ.png"},
     {name:"–ë–µ—Ä–µ–≥–æ–≤–∏–π –ö–∞–±–∞–Ω", hp:30, str:4, agi:2, armor:1, exp:9, drops:[{name:"–ú º—è—Å–æ", img:"https://i.imgur.com/Q7cR6s2.png", chance:0.5},{name:"–Ü–∫–ª–æ", img:"https://i.imgur.com/T1HlzIj.png", chance:0.2}], img:"https://i.imgur.com/Q7cR6s2.png"},
     {name:"–ó–∞–±–ª—É–∫–∞–ª–∏–π –í–æ–≤–∫", hp:28, str:4, agi:5, armor:1, exp:14, drops:[{name:"–•—É—Ç—Ä–æ", img:"https://i.imgur.com/1SgX3sJ.png", chance:0.6},{name:"–ó—É–±", img:"https://i.imgur.com/9R5tTnL.png", chance:0.25}], img:"https://i.imgur.com/9R5tTnL.png"}
   ]},
  {name:"–†—É—ó–Ω–∏ –°—Ç–∞—Ä–æ–¥–∞–≤–Ω—å–æ–≥–æ –§–æ—Ä—Ç–∞", img:"https://i.imgur.com/3Lz2p1Q.png", text:"–†—É—ó–Ω–∏ —Å—Ç–∞—Ä–æ–¥–∞–≤–Ω—å–æ–≥–æ —Ñ–æ—Ä—Ç—É —Å—Ç–æ—è—Ç—å –Ω–∞ –ø–∞–≥–æ—Ä–±—ñ, –æ–±–ª—ñ–ø–ª–µ–Ω—ñ –º–æ—Ö–æ–º. –¢–∏—à–∞ –ª–µ–¥—å –ø–æ—Ä—É—à—É—î—Ç—å—Å—è –∫—Ä–æ–∫–∞–º–∏. –¢—É—Ç —Ç–∏ –≤—ñ–¥—á—É–≤–∞—î—à –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å —Å—Ç–∞—Ä–æ–¥–∞–≤–Ω—ñ—Ö —Ç—ñ–Ω–µ–π‚Ä¶",
   mobs:[
     {name:"–¢—ñ–Ω—å –†—É—ó–Ω", hp:22, str:5, agi:4, armor:2, exp:20, drops:[{name:"–£–ª–∞–º–æ–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É", img:"https://i.imgur.com/2RZmL5v.png", chance:0.15},{name:"–ö–∞–º—ñ–Ω—å", img:"https://i.imgur.com/Q7cR6s2.png", chance:0.4}], img:"https://i.imgur.com/2RZmL5v.png"},
     {name:"–°–∫–µ–ª–µ—Ç-–æ—Ö–æ—Ä–æ–Ω–µ—Ü—å", hp:30, str:6, agi:3, armor:3, exp:25, drops:[{name:"–ö—ñ—Å—Ç–∫–∞", img:"https://i.imgur.com/5tXeGjB.png", chance:0.6},{name:"–ó—É–±", img:"https://i.imgur.com/9R5tTnL.png", chance:0.2}], img:"https://i.imgur.com/1aKzS6n.png"},
     {name:"–î—É—Ö –§–æ—Ä—Ç–µ—Ü—ñ", hp:50, str:8, agi:5, armor:4, exp:60, drops:[{name:"–ê—Ä—Ç–µ—Ñ–∞–∫—Ç", img:"https://i.imgur.com/ZbZ6F5B.png", chance:1},{name:"–ö–∞–º—ñ–Ω—å –º–∞–≥—ñ—ó", img:"https://i.imgur.com/Q7cR6s2.png", chance:0.3}], img:"https://i.imgur.com/O5b8xXJ.png", elite:true, cooldown:600000}
   ]}
];

let currentLocation = locations[0];
let currentMob = null;
let eliteCooldowns = {};
let battleLog = document.getElementById('battle-log');

function addLog(text){ battleLog.innerHTML += text+'<br>'; battleLog.scrollTop=battleLog.scrollHeight; }
function chooseMob() {
  if (!currentMob || currentMob.hp<=0){
    let availableMobs = currentLocation.mobs.filter(m=>{
      if(!m.elite) return true;
      let last = eliteCooldowns[m.name]||0;
      return Date.now()-last > m.cooldown;
    });
    if(availableMobs.length==0){ addLog("–ù–µ–º–∞—î –º–æ–±—ñ–≤ –¥–ª—è —Ñ–∞—Ä–º—É –∑–∞—Ä–∞–∑, –ø–æ—á–µ–∫–∞–π —Ç—Ä–æ—Ö–∏."); return; }
    currentMob = {...availableMobs[Math.floor(Math.random()*availableMobs.length)]};
    if(currentMob.elite) eliteCooldowns[currentMob.name] = Date.now();
    addLog(`–¢–∏ –∑—É—Å—Ç—Ä—ñ–≤ ${currentMob.name}! (HP: ${currentMob.hp})`);
    document.getElementById('location-img').style.backgroundImage = `url('${currentMob.img}')`;
  }
}

function attackMob(){
  chooseMob();
  if(!currentMob) return;
  let hitChance = 0.75 + character.mastery*0.02;
  if(Math.random()>hitChance) addLog("–¢–∏ –ø—Ä–æ–º–∞—Ö–Ω—É–≤—Å—è!");
  else{
    let damage = Math.max(1, Math.floor(character.strength*(0.8+Math.random()*0.4)-currentMob.armor));
    if(Math.random()<0.05+character.luck*0.01) damage = Math.floor(damage*1.5);
    currentMob.hp -= damage;
    addLog(`–¢–∏ –∑–∞–≤–¥–∞—î—à ${damage} —à–∫–æ–¥–∏ ${currentMob.name}! (HP –º–æ–±–∞: ${currentMob.hp})`);
  }

  if(currentMob.hp>0){
    let mobDamage = Math.max(1, Math.floor(currentMob.str*(0.8+Math.random()*0.4)));
    character.hp -= mobDamage;
    document.getElementById('hp').innerText = character.hp;
    addLog(`${currentMob.name} –∞—Ç–∞–∫—É—î —Ç–µ–±–µ ‚Äî ${mobDamage} —à–∫–æ–¥–∏! (HP: ${character.hp})`);
  }else{
    addLog(`${currentMob.name} –ø–µ—Ä–µ–º–æ–∂–µ–Ω–∏–π!`);
    gainExp(currentMob.exp);
    dropItems(currentMob.drops);
    currentMob=null;
    document.getElementById('location-img').style.backgroundImage = `url('${currentLocation.img}')`;
  }

  if(character.hp<=0){
    addLog("–¢–∏ –Ω–µ–ø—Ä–∏—Ç–æ–º–Ω—ñ—î—à —ñ –ø—Ä–∏—Ö–æ–¥–∏—à –¥–æ —Ç—è–º–∏ –Ω–∞ —É–∑–±–µ—Ä–µ–∂–∂—ñ...");
    character.hp = Math.max(20, character.endurance*5);
    document.getElementById('hp').innerText = character.hp;
  }
}

function gainExp(exp){
  character.exp += exp;
  addLog(`–¢–∏ –æ—Ç—Ä–∏–º–∞–≤ ${exp} EXP! (–í—Å—å–æ–≥–æ: ${character.exp})`);
  if(character.exp>=character.level*20){
    character.level++; character.exp=0;
    addLog("–í—ñ—Ç–∞—î–º–æ! –¢–∏ –ø—ñ–¥–≤–∏—â–∏–≤ —Ä—ñ–≤–µ–Ω—å!");
    document.getElementById('level').innerText=character.level;
    character.hp=character.endurance*5+20;
    document.getElementById('hp').innerText=character.hp;
  }
}

function dropItems(drops){
  drops.forEach(item=>{
    if(Math.random()<item.chance*(1+character.luck*0.02)){
      character.inventory.push(item);
      addLog(`–¢–∏ –æ—Ç—Ä–∏–º–∞–≤ –¥—Ä–æ–ø: ${item.name}`);
    }
  });
}

function explore(){ addLog("–¢–∏ –¥–æ—Å–ª—ñ–¥–∂—É—î—à —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—é‚Ä¶ –Ω—ñ—á–æ–≥–æ —Ü—ñ–∫–∞–≤–æ–≥–æ –Ω–µ –∑–Ω–∞—Ö–æ–¥–∏—à."); }
function showCharacter(){ addLog(`–ü–µ—Ä—Å–æ–Ω–∞–∂: –ì–µ—Ä–æ–π, —Ä—ñ–≤–µ–Ω—å ${character.level}, HP: ${character.hp}`); }

function openInventory(){
  let modal=document.getElementById('inventory-modal');
  let container=document.getElementById('inventory-items');
  container.innerHTML='';
  character.inventory.forEach(it=>{
    let div=document.createElement('div');
    div.className='item';
    div.innerHTML=`<img src='${it.img}' alt='${it.name}'>${it.name}`;
    container.appendChild(div);
  });
  modal.style.display='block';
}
function closeInventory(){ document.getElementById('inventory-modal').style.display='none'; }

// –ö—Ä–∞—Ñ—Ç
let recipes = [
  {name:"–ü–æ—Å–∏–ª–µ–Ω–∏–π –ù—ñ–∂", requires:[{name:"–°—Ç–∞—Ä–∏–π –Ω—ñ–∂", qty:1},{name:"–ö–∞–º—ñ–Ω—å –º–∞–≥—ñ—ó", qty:1}]},
  {name:"–ë—Ä–æ–Ω—è –†—É—ó–Ω", requires:[{name:"–ü–æ—Ç–µ—Ä—Ç–∞ –∫—É—Ä—Ç–∫–∞", qty:1},{name:"–ö–∞–º—ñ–Ω—å", qty:2}]},
  {name:"–ê—Ä—Ç–µ—Ñ–∞–∫—Ç –°–∏–ª–∏", requires:[{name:"–£–ª–∞–º–æ–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É", qty:3},{name:"–ö–∞–º—ñ–Ω—å –º–∞–≥—ñ—ó", qty:2}]}
];

function openCraft(){
  let modal=document.getElementById('craft-modal');
  let list=document.getElementById('craft-list');
  list.innerHTML='';
  recipes.forEach((r,i)=>{
    let div=document.createElement('div');
    div.style.margin="10px 0";
    div.innerHTML=`<strong>${r.name}</strong> <button onclick="craftItem(${i})">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>`;
    let reqs=document.createElement('div'); reqs.style.fontSize="12px";
    reqs.innerText="–ü–æ—Ç—Ä—ñ–±–Ω–æ: "+r.requires.map(x=>x.qty+"x "+x.name).join(", ");
    div.appendChild(reqs);
    list.appendChild(div);
  });
  modal.style.display='block';
}
function closeCraft(){ document.getElementById('craft-modal').style.display='none'; }
function craftItem(index){
  let r=recipes[index];
  if(!r.requires.every(req=>character.inventory.filter(i=>i.name===req.name).length>=req.qty)){
    addLog(`–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –¥–ª—è ${r.name}`); return;
  }
  r.requires.forEach(req=>{for(let i=0;i<req.qty;i++){let idx=character.inventory.findIndex(it=>it.name===req.name); if(idx>=0) character.inventory.splice(idx,1);} });
  character.inventory.push({name:r.name,img:"https://i.imgur.com/ZbZ6F5B.png"});
  addLog(`–í—ñ—Ç–∞—î–º–æ! –í–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏: ${r.name}`);
  openInventory();
}

// –í–∏–±—ñ—Ä –ª–æ–∫–∞—Ü—ñ—ó
function openLocationModal(){
  let modal=document.getElementById('location-modal');
  let list=document.getElementById('location-list');
  list.innerHTML='';
  locations.forEach((loc,i)=>{
    let btn=document.createElement('button');
    btn.innerText=loc.name; btn.onclick=()=>{changeLocation(i); closeLocationModal();};
    list.appendChild(btn);
  });
  modal.style.display='block';
}
function closeLocationModal(){ document.getElementById('location-modal').style.display='none'; }
function changeLocation(index){
  currentLocation=locations[index]; currentMob=null;
  document.getElementById('location-name').innerText=currentLocation.name;
  document.getElementById('location-text').innerText=currentLocation.text;
  document.getElementById('location-img').style.backgroundImage=`url('${currentLocation.img}')`;
  addLog(`–¢–∏ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏–≤—Å—è –¥–æ: ${currentLocation.name}`);
}
function changeLocationUI(){ openLocationModal(); }

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
changeLocation(0);
</script>
</body>
</html>